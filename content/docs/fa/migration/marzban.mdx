---
title: Marzban ุจู ูพุงุณุงุฑฺฏุงุฑุฏ
icon: ArrowRightLeft
---

<Alert type="warning">
ุงู ุฑุงูููุง ุจุฑุง ูุณุฎูโูุง `beta-3` ู ูพุงูโุชุฑ Marzban ูุณุช.
</Alert>

ุงู ุฑุงูููุง ุจูุชูู ฺฉูฺฉ ูโฺฉูู ุชุง ุงุทูุงุนุงุชุ ุชูุธูุงุช ู ุงฺฉุงูุชโูุง ฺฉุงุฑุจุฑุชูู ุฑู ุงุฒ Marzban ุจู ูพุงุณุงุฑฺฏุงุฑุฏ ููุชูู ฺฉูุฏุ ุจุฏูู ุงูฺฉู ฺุฒ ุงุฒ ุฏุณุช ุจุฑู.

ุฏู ุฑูุด ููุงุฌุฑุช ุชูุถุญ ุฏุงุฏู ูโุดู. ุดูุง ูโุชููุฏ ูุฑ ฺฉุฏูู ฺฉู ุจุงูุงุด ุฑุงุญุชโุชุฑ ูุณุชุฏ ุฑู ุงูุชุฎุงุจ ฺฉูุฏ.

- [Marzban ููุงุฌุฑุช ุงุฒ ูุตุจ ูุนู](/fa/migration/marzban/#ูุฑุงุญู-ููุงุฌุฑุช-ูุตุจ-ูุนู)

ููู ุชูุธูุงุช ู ูุงูโูุง ูุนู ุดูุง ุญูุธ ูโุดู. ูุงุฒ ุจู ุณุฑูุฑ ุฌุฏุฏ ูุณุชุ ูู ฺฉู ูพฺุฏูโุชุฑู ู ุฏุณุชูุฑุงุช ุจุดุชุฑ ุฏุงุฑู.

- [PasarGuard ููุงุฌุฑุช ุจุง ูุตุจ ุฌุฏุฏ](/fa/migration/marzban/#ูุฑุงุญู-ููุงุฌุฑุช-ูุตุจ-ุฌุฏุฏ)

ุงู ุฑูุด ุฑุงุญุชโุชุฑ ู ุณุฑุนโุชุฑูุ ุจุง ุฏุณุชูุฑุงุช ฺฉูุชุฑ. ูู ุจู ุณุฑูุฑ ุฌุฏุฏ ูุงุฒ ุฏุงุฑู ู ุจุนุถ ุชูุธูุงุช ุฑู ุจุงุฏ ุจุนุฏ ุงุฒ ููุงุฌุฑุช ุจูโุตูุฑุช ุฏุณุช ุงูุฌุงู ุจุฏุฏ.

## ูพุดโูุงุฒูุง

> โ๏ธ **ููู**: ููุดู ูุจู ุงุฒ ุดุฑูุน ูุฑุขูุฏ ููุงุฌุฑุชุ ู ุจฺฉโุขูพ ฺฉุงูู ุงุฒ ุงุทูุงุนุงุชุชูู ุฏุงุดุชู ุจุงุดุฏ.

- ูุทูุฆู ุจุดุฏ ฺฉู ุจู ุณุฑูุฑุชูู ุฏุณุชุฑุณ root ุฏุงุฑุฏ.
- ู ุจฺฉโุขูพ ุงุฒ ูุตุจ ูุนู Marzban ุฏุงุดุชู ุจุงุดุฏ.
- ฺฺฉ ฺฉูุฏ ฺฉู Docker ู Docker Compose ูุตุจ ุจุงุดู.

## ูุฑุงุญู ููุงุฌุฑุช: ูุตุจ ูุนู

### 1. ุณุฑูุณโูุง Marzban ุฑู ูุชููู ฺฉูุฏ

ุงูู ุงุฒ ูููุ ููู ฺฉุงูุชูุฑูุง ุฏุฑ ุญุงู ุงุฌุฑุง Marzban ุฑู ูุชููู ฺฉูุฏ:

#### ุฏุณุชูุฑุงุช ุชููู ุณุฑูุณ

```bash
cd /opt/marzban
docker compose down
```

### 2. ุงุณู ูพูุดู ุงุตู ุฑู ุนูุถ ฺฉูุฏ

ุงฺฏู ูพูุดูโูุง ูพุงุณุงุฑฺฏุงุฑุฏ ุงุฒ ูุจู ูุฌูุฏ ุฏุงุฑูุ ุงูููุง ุฑู ุญุฐู ฺฉูุฏ:

#### ุฏุณุชูุฑ ุญุฐู ูพูุดูโูุง

```bash
rm -r /opt/pasarguard /var/lib/pasarguard /var/lib/mysql/pasarguard
```

ุงุณู ูพูุดู ุงุตู Marzban ุฑู ุจู PasarGuard ุชุบุฑ ุจุฏุฏ:

#### ุฏุณุชูุฑ ุชุบุฑ ูุงู ูพูุดู

```bash
sudo mv /opt/marzban /opt/pasarguard
```

### 3. ุงุณู ูพูุดู ุฏุชุง ุฑู ุนูุถ ฺฉูุฏ

ุงุณู ูพูุดู ุฏุชุง ุฑู ูู ุชุบุฑ ุจุฏุฏ:

#### ุฏุณุชูุฑ ุชุบุฑ ูุงู ูพูุดู ุฏุชุง

```bash
sudo mv /var/lib/marzban /var/lib/pasarguard
```

### 4. ุงุณู ูพูุดู MySQL ุฑู ุนูุถ ฺฉูุฏ (ุงฺฏู ุงุณุชูุงุฏู ูโฺฉูุฏ)

ุงฺฏู ุงุฒ MySQL ุง MariaDB ุงุณุชูุงุฏู ูโฺฉูุฏ ู ู ูพูุดู ุงุฎุชุตุงุต ุจุฑุง ุฏุชุงุจุณ Marzban ุฏุงุฑุฏ:

#### ุฏุณุชูุฑ ุชุบุฑ ูุงู ูพูุดู MySQL

```bash
sudo mv /var/lib/mysql/marzban /var/lib/mysql/pasarguard
```

<Alert type="info">
ุงฺฏุฑ ุจุง ุฎุทุง ยซูุงู ุง ูพูุดู ูุฌูุฏ ูุฏุงุฑุฏยป ููุงุฌู ุดุฏุฏุ ููฺฉูู ูพูุดู MySQL ูุชูุงูุช ุจุงุดุฏ. ุฏุฑ ุงู ุตูุฑุช ุงุฒ ุงู ุฏุณุชูุฑ ุงุณุชูุงุฏู ฺฉูุฏ:
```bash
mkdir -p /var/lib/mysql/pasarguard
mv /var/lib/pasarguard/mysql/* /var/lib/mysql/pasarguard
rm -r /var/lib/pasarguard/mysql
```
</Alert>

### 5. ูุชุบุฑูุง ูุญุท ุฑู ุจูโุฑูุฒ ฺฉูุฏ

ุจุฑุฏ ุจู ูพูุดู ุฌุฏุฏ PasarGuard ู ูุงู ูุญุท ุฑู ุจูโุฑูุฒ ฺฉูุฏ:

```bash
cd /opt/pasarguard
```

ููู ูุณุฑูุง ุงุดุงุฑู ุดุฏู ุชู ูุงู `.env` ุฑู ุจุง ู ุฏุณุชูุฑ ุณุงุฏู ุจูโุฑูุฒ ฺฉูุฏ:

```bash
sudo sed -i 's|/var/lib/marzban|/var/lib/pasarguard|g' .env
```

<Alert type="warning">
ุงฺฏู ุงุฒ ูุณุฎู ูุฏู (0.8.4 ุง ูพุงูโุชุฑ) ุงุณุชูุงุฏู ูโฺฉูุฏุ ุจุงุฏ ุฏุฑุงูุฑ SQL ุฑู ูู ุชุบุฑ ุจุฏุฏ:
</Alert>

ูุงู `.env` ุฑู ุจุงุฒ ฺฉูุฏ:

```bash
nano .env
```

<Tabs items={['SQLite', 'MySQL']}>
  <Tab value="SQLite">
    <div dir="rtl">
      ### ุจูโุฑูุฒุฑุณุงู ุฏุฑุงูุฑ SQLite

      โ ูุฏู
      ```dotenv
      SQLALCHEMY_DATABASE_URL = "sqlite:////var/lib/marzban/db.sqlite3"
      ```
      โ ุฌุฏุฏ
      ```dotenv
      SQLALCHEMY_DATABASE_URL = "sqlite+aiosqlite:////var/lib/pasarguard/db.sqlite3"
      ```
    </div>
  </Tab>

  <Tab value="MySQL">
    <div dir="rtl">
      ### ุจูโุฑูุฒุฑุณุงู ุฏุฑุงูุฑ MySQL
      ุจุฑุง MariaDBุ ูููู ุฑููุฏ ฺฉู ุจุฑุง MySQL ูุณุช ุฑู ุฏูุจุงู ฺฉูุฏ.
      > โ๏ธ **ุชูุฌู**: ุฏุฑ ุงู ูุซุงูุ ููุฏุงุฑ `MYSQL_ROOT_PASSWORD` ุจุงุฏ ุจุง ููุฏุงุฑ ูุงูุน ุงูู ุฏุฑ ูุงู `.env` ุดูุง ุฌุงฺฏุฒู ุจุดู.

      โ ูุฏู
      ```dotenv
      SQLALCHEMY_DATABASE_URL = "mysql+pymysql://root:MYSQL_ROOT_PASSWORD@127.0.0.1/marzban"
      ```
      โ ุฌุฏุฏ
      ```dotenv
      SQLALCHEMY_DATABASE_URL = "mysql+asyncmy://root:MYSQL_ROOT_PASSWORD@127.0.0.1/pasarguard"
      ```
    </div>
  </Tab>
</Tabs>

### ุณุงุฑ ุชุบุฑุงุช

ุงฺฏุฑ ุฏุฑ ูุงู `.env` ุฎูุฏ ุงุฒ `V2RAY_SUBSCRIPTION_TEMPLATE` ุงุณุชูุงุฏู ูโฺฉูุฏ ุง ฺฉ `TLS Inbound` ุชูุธู ุดุฏู ุฏุงุฑุฏุ ุจุงุฏ ุงููโูุง ุฑู ุจูโุฑูุฒ ฺฉูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ูโุชููุฏ ุงู ูุฑุญูู ุฑู ุฑุฏ ฺฉูุฏ.

#### ุฏุณุชูุฑ ุชุบุฑ ูุงู ูพูุดู v2ray ุจู xray

ูพูุดู v2ray ุฑู ุจุง ุงู ุฏุณุชูุฑ ุจู xray ุชุบุฑ ุจุฏุฏ:

```bash
mv /var/lib/pasarguard/templates/v2ray /var/lib/pasarguard/templates/xray
```

#### ุจูโุฑูุฒุฑุณุงู ูพูุดูโูุง ฺฏูุงู xray-config

ุงฺฏุฑ ฺฉ `TLS Inbound` ุฏุงุฑุฏุ ุจุงุฏ `xray_config.json` ุฑู ูุฑุงุด ฺฉูุฏ ู ูพูุดูโูุง ฺฏูุงู ุฑุง ุงุฒ marzban ุจู pasarguard ุชุบุฑ ุจุฏุฏ:

```bash
nano /var/lib/pasarguard/xray_config.json
```

ูพุณ ุงุฒ ุชุบุฑุงุชุ ูุงู `.env` ู `xray_config.json` ุดูุง ุจุงุฏ ฺุฒ ุดุจู ุจู ุงู ุจุงุดู:

<Tabs items={['XRAY_SUBSCRIPTION_TEMPLATE', 'Xray-Config Certificate Directories']}>
  <Tab value="XRAY_SUBSCRIPTION_TEMPLATE">
    <div dir="rtl">
      ### ุจูโุฑูุฒุฑุณุงู ุชููพูุช Xray ุฏุฑ `.env`

      โ ูุฏู
      ```dotenv
      V2RAY_SUBSCRIPTION_TEMPLATE = "v2ray/default.json"
      ```
      โ ุฌุฏุฏ
      ```dotenv
      XRAY_SUBSCRIPTION_TEMPLATE = "xray/default.json"
      ```
    </div>
  </Tab>

  <Tab value="Xray-Config Certificate Directories">
    <div dir="rtl">
      ### ุจูโุฑูุฒุฑุณุงู ูพูุดูโูุง ฺฏูุงู ุฏุฑ `xray_config.json`

      โ ูุฏู
      ```json
            "certificates": [
              {
                "certificateFile": "/var/lib/marzban/certs/example.com/fullchain.pem",
                "keyFile": "/var/lib/marzban/certs/example.com/key.pem"
              }
            ],
      ```
      โ ุฌุฏุฏ
      ```json
            "certificates": [
              {
                "certificateFile": "/var/lib/pasarguard/certs/example.com/fullchain.pem",
                "keyFile": "/var/lib/pasarguard/certs/example.com/key.pem"
              }
            ],
      ```
    </div>
  </Tab>
</Tabs>

### 6. ูุงู Docker Compose ุฑู ุจูโุฑูุฒ ฺฉูุฏ

ูุงู `docker-compose.yml` ุฑู ุจุฑุง ูุดูู ุฏุงุฏู ูุณุฑูุง ุฌุฏุฏ ุจูโุฑูุฒ ฺฉูุฏ. ุจุงุฏ ุงู ูุงู ุฑู ุฏุณุช ูุฑุงุด ฺฉูุฏ:

```bash
sudo nano docker-compose.yml
```

#### ุชุบุฑุงุช Docker Compose

ุงูุฌุง ู ููุงุณู ูุณุช ฺฉู ุชุบุฑุงุช ูุงุฒู ุฑู ุจุฑุง ูุฑ ุฏุชุงุจุณ ูุดูู ูุฏู:

<Accordions type="multiple">
  <Accordion title="SQLite">
<div className="grid md:grid-cols-2 gap-4">

<div className="space-y-2">

**โ ูุจู (Marzban)**
```yaml
services:
  marzban:
    image: gozargah/marzban:latest
    restart: always
    env_file: .env
    network_mode: host
    volumes:
      - /var/lib/marzban:/var/lib/marzban
```

</div>

<div className="space-y-2">

**โ ุจุนุฏ (PasarGuard)**
```yaml
services:
  pasarguard:
    image: pasarguard/panel:latest
    restart: always
    env_file: .env
    network_mode: host
    volumes:
      - /var/lib/pasarguard:/var/lib/pasarguard
```

</div>

</div>

</Accordion>

<Accordion title="MySQL">
  <Alert type="warning">
    โ๏ธ **ุชูุฌู**: ุงฺฏู ุงุฒ ูุจู ุงุฒ ุงูุฌ `mysql:latest` ุงุณุชูุงุฏู ูโฺฉูุฏุ ุงูู ุฑู ุจู ุงูุฌ `mysql:lts` ุชุบุฑ ูุฏุฏุ ฺูู ฺฏุงู ููฺฉูู ูุดฺฉูุงุช ุงุฌุงุฏ ฺฉูู.
  </Alert>

  <div className="grid md:grid-cols-2 gap-4">

    <div className="space-y-2">

**โ ูุจู (Marzban)**
```yaml
services:
  marzban:
    image: gozargah/marzban:latest
    restart: always
    env_file: .env
    network_mode: host
    volumes:
      - /var/lib/marzban:/var/lib/marzban
    depends_on:
      - mysql

  mysql:
    image: mysql:lts
    restart: always
    env_file: .env
    network_mode: host
    command: --bind-address=127.0.0.1 --mysqlx-bind-address=127.0.0.1 --disable-log-bin
    environment:
      MYSQL_DATABASE: marzban
    volumes:
      - /var/lib/mysql/marzban:/var/lib/mysql
```

</div>

<div className="space-y-2">

**โ ุจุนุฏ (PasarGuard)**
```yaml
services:
  pasarguard:
    image: pasarguard/panel:latest
    restart: always
    env_file: .env
    network_mode: host
    volumes:
      - /var/lib/pasarguard:/var/lib/pasarguard
    depends_on:
      - mysql

  mysql:
    image: mysql:lts
    restart: always
    env_file: .env
    network_mode: host
    command: --bind-address=127.0.0.1 --mysqlx-bind-address=127.0.0.1 --disable-log-bin
    environment:
      MYSQL_DATABASE: pasarguard
    volumes:
      - /var/lib/mysql/pasarguard:/var/lib/mysql
```

</div>

</div>

  </Accordion>

  <Accordion title="MariaDB">
  <Alert type="warning">
    โ๏ธ **ุชูุฌู**: ุงฺฏู ุงุฒ ูุจู ุงุฒ ุงูุฌ `mariadb:latest` ุงุณุชูุงุฏู ูโฺฉูุฏุ ุงูู ุฑู ุจู ุงูุฌ `mariadb:lts` ุชุบุฑ ูุฏุฏุ ฺูู ฺฏุงู ููฺฉูู ูุดฺฉูุงุช ุงุฌุงุฏ ฺฉูู.
  </Alert>

  <div className="grid md:grid-cols-2 gap-4">

    <div className="space-y-2">

**โ ูุจู (Marzban)**
```yaml
services:
  marzban:
    image: gozargah/marzban:latest
    restart: always
    env_file: .env
    network_mode: host
    volumes:
      - /var/lib/marzban:/var/lib/marzban
    depends_on:
      - mariadb

  mariadb:
    image: mariadb:lts
    restart: always
    env_file: .env
    network_mode: host
    command: --bind-address=127.0.0.1 --disable-log-bin
    environment:
      MYSQL_DATABASE: marzban
    volumes:
      - /var/lib/mysql/marzban:/var/lib/mysql
```

</div>

<div className="space-y-2">

**โ ุจุนุฏ (PasarGuard)**
```yaml
services:
  pasarguard:
    image: pasarguard/panel:latest
    restart: always
    env_file: .env
    network_mode: host
    volumes:
      - /var/lib/pasarguard:/var/lib/pasarguard
    depends_on:
      - mariadb

  mariadb:
    image: mariadb:lts
    restart: always
    env_file: .env
    network_mode: host
    command: --bind-address=127.0.0.1 --disable-log-bin
    environment:
      MYSQL_DATABASE: pasarguard
    volumes:
      - /var/lib/mysql/pasarguard:/var/lib/mysql
```

</div>

</div>

  </Accordion>
</Accordions>

#### ุฎูุงุตู ุชุบุฑุงุช ฺฉูุฏ:

<div className="overflow-x-auto">
<table>
<thead>
<tr>
<th>ุจุฎุด</th>
<th>ูุจู</th>
<th>ุจุนุฏ</th>
</tr>
</thead>
<tbody>
<tr>
<td data-label="ุจุฎุด"><strong>ุงุณู ุณุฑูุณ</strong></td>
<td data-label="ูุจู"><code>marzban</code></td>
<td data-label="ุจุนุฏ"><code>pasarguard</code></td>
</tr>
<tr>
<td data-label="ุจุฎุด"><strong>ุงูุฌ Docker</strong></td>
<td data-label="ูุจู"><code>gozargah/marzban:latest</code></td>
<td data-label="ุจุนุฏ"><code>pasarguard/panel:latest</code></td>
</tr>
<tr>
<td data-label="ุจุฎุด"><strong>ูููู ุจุฑูุงูู</strong></td>
<td data-label="ูุจู"><code>/var/lib/marzban:/var/lib/marzban</code></td>
<td data-label="ุจุนุฏ"><code>/var/lib/pasarguard:/var/lib/pasarguard</code></td>
</tr>
<tr>
<td data-label="ุจุฎุด"><strong>ุฏุชุงุจุณ MySQL</strong></td>
<td data-label="ูุจู"><code>marzban</code></td>
<td data-label="ุจุนุฏ"><code>pasarguard</code></td>
</tr>
<tr>
<td data-label="ุจุฎุด"><strong>ูููู MySQL</strong></td>
<td data-label="ูุจู"><code>/var/lib/mysql/marzban:/var/lib/mysql</code></td>
<td data-label="ุจุนุฏ"><code>/var/lib/mysql/pasarguard:/var/lib/mysql</code></td>
</tr>
</tbody>
</table>
</div>

### 7. ุชุบุฑ ุฏุชุงุจุณ MySQL ูุฑุฒุจุงู ุจู ูพุงุณุงุฑฺฏุงุฑุฏ (ุฏุฑ ุตูุฑุช ุงุณุชูุงุฏู)

ุงฺฏุฑ ุงุฒ ุฏุชุงุจุณ SQLite ุงุณุชูุงุฏู ูโฺฉูุฏุ ุงู ูุฑุญูู ุฑู ุฑุฏ ฺฉูุฏ.

ุงูุง ุงฺฏุฑ ุงุฒ MySQL ุง MariaDB ุงุณุชูุงุฏู ูโฺฉูุฏุ ุจุงุฏ ุงุฒ ุฏุชุงุจุณ ูุฑุฒุจุงู ุฎุฑูุฌ ุจฺฏุฑุฏ ุชุง ุจุนุฏุงู ุจู ุนููุงู ุฏุชุงุจุณ ูพุงุณุงุฑฺฏุงุฑุฏ ูุงุฑุฏ ุจุดู.

> โ๏ธ **ุชูุฌู**: ุชูุงู ุฏุณุชูุฑุงุช ุฒุฑ ุจุฑุง ููุงุฌุฑุช ุฏุชุงุจุณ ุจุงุฏ ุฏุฑ ุญุงู ุงุฌุฑุง ุดููุฏ ฺฉู ุฏุฑ ูุณุฑ `/opt/pasarguard/` ูุณุชุฏ.

#### ุงุฌุฑุง MySQL ุง MariaDB

ุงุจุชุฏุง ุณุฑูุณ MySQL ุง MariaDB ุฑุง ุจุณุชู ุจู ุงูฺฉู ฺฉุฏุงู ุฑุง ุงุณุชูุงุฏู ูโฺฉูุฏุ ุงุฌุฑุง ฺฉูุฏ.

<Tabs items={['MySQL', 'MariaDB']}>
  <Tab value="MySQL">
```bash
cd /opt/pasarguard && docker compose up -d mysql
```
  </Tab>

  <Tab value="MariaDB">
```bash
cd /opt/pasarguard && docker compose up -d mariadb
```
  </Tab>
</Tabs>

#### ฺฏุฑูุชู ุฎุฑูุฌ ุงุฒ ุฏุชุงุจุณ
ุฏุฑ ุงู ูุฑุญูู ุงุฒุชูู ูพุณูุฑุฏ ุฏุชุงุจุณ ุฎูุงุณุชู ูุดู. ูููู ููุฏุงุฑ `MYSQL_ROOT_PASSWORD` ฺฉู ุฏุงุฎู ูุงู `.env` ูุณุช ุฑู ูุงุฑุฏ ฺฉูุฏ:

<Tabs items={['MySQL', 'MariaDB']}>
  <Tab value="MySQL">
```bash
docker compose exec mysql mysqldump -u root -p -h 127.0.0.1 --databases marzban > "/opt/pasarguard/marzban.sql"
```
  </Tab>

  <Tab value="MariaDB">
```bash
docker compose exec mariadb mariadb-dump -u root -p -h 127.0.0.1 --databases marzban > "/opt/pasarguard/marzban.sql"
```
  </Tab>
</Tabs>

<Alert type="info">
ุงฺฏุฑ ุจุง ุฎุทุง "Access Denied" ุฑูุจูโุฑู ุดุฏุฏุ ุจู ุฌุง ูุฒุฑ `root` ุงุฒ ูุฒุฑ `marzban` ุจู ููุฑุงู ูพุณูุฑุฏ `MYSQL_PASSWORD` ุฏุงุฎู `.env` ุงุณุชูุงุฏู ฺฉูุฏ:
<Tabs items={['MySQL', 'MariaDB']}>
  <Tab value="MySQL">
```bash
docker compose exec mysql mysqldump -u marzban -p -h 127.0.0.1 --databases marzban > "/opt/pasarguard/marzban.sql"
```
  </Tab>

  <Tab value="MariaDB">
```bash
docker compose exec mariadb mariadb-dump -u marzban -p -h 127.0.0.1 --databases marzban > "/opt/pasarguard/marzban.sql"
```
  </Tab>
</Tabs>
</Alert>

#### ูุฑุงุด ุงุทูุงุนุงุช ุฏุชุงุจุณ

ุงู ูุฑุญูู ุฎู ูููู ฺูู ุจุงุฏ ุฏุชุงุจุณ pasarguard ุฏุงุฎู MySQL ุณุงุฎุชู ุจุดู.
ุจุง ุฏุณุชูุฑ ุฒุฑ ุงุณู "marzban" ุจู "pasarguard" ุชู ุฏู ุฎุท ููู (`CREATE DATABASE` ู `USE`) ุชุบุฑ ุฏุงุฏู ูุดู:

```bash
sed -i '/^CREATE DATABASE/s/marzban/pasarguard/;/^USE/s/marzban/pasarguard/' /opt/pasarguard/marzban.sql
```

#### ูุงุฑุฏ ฺฉุฑุฏู ุฏุชุงุจุณ ูพุงุณุงุฑฺฏุงุฑุฏ

ุจุฑุง ูุงุฑุฏ ฺฉุฑุฏู ุฏุชุงุจุณ ุฌุฏุฏุ ููุฏุงุฑ `MYSQL_ROOT_PASSWORD` ฺฉู ุฏุงุฎู `.env` ูุณุช ุฑู ุฏุฑ ุฏุณุชูุฑ ุฒุฑ ุฌุงฺฏุฒู ฺฉูุฏ ู ุงุฌุฑุง ฺฉูุฏ:

<Tabs items={['MySQL', 'MariaDB']}>
  <Tab value="MySQL">
```bash
docker compose exec -T mysql mysql -u root -p"MYSQL_ROOT_PASSWORD" -h 127.0.0.1 < "/opt/pasarguard/marzban.sql"
```
  </Tab>

  <Tab value="MariaDB">
```bash
docker compose exec -T mariadb mariadb -u root -p"MYSQL_ROOT_PASSWORD" -h 127.0.0.1 < "/opt/pasarguard/marzban.sql"
```
  </Tab>
</Tabs>

<Callout type="warning">
ุงู ูพุฑูุณู ููฺฉูู ฺฉู ุฒูุงู ุจุจุฑู.
</Callout>

<Alert type="success">
ุงฺฏู ูฺ ุฎุฑูุฌโุง ูุดุงูุฏู ูฺฉุฑุฏุฏุ ูุดูููโ ุฎูุจ ูุณุช.
ุจุฑุง ุงุทููุงู ุงุฒ ููููุชโุขูุฒ ุจูุฏู ูุงุฑุฏ ฺฉุฑุฏู ุฏุชุงุจุณุ ุฏุชุงุจุณโูุง MySQL ุฑู ูุณุช ฺฉูุฏ. ุจุงุฏ `pasarguard` ุฑู ุจู ุงูููุง ุจุจูุฏ.

ูุณูุช `MYSQL_ROOT_PASSWORD` ุฑู ุจุง ููุฏุงุฑุด ุฏุฑ ูุงู `.env` ุฌุงฺฏุฒู ฺฉุฑุฏู ู ุฏุณุชูุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ.

<Tabs items={['MySQL', 'MariaDB']}>
  <Tab value="MySQL">
```bash
docker compose exec mysql mysql -u root -p"MYSQL_ROOT_PASSWORD" -e "SHOW DATABASES;"
```
  </Tab>

  <Tab value="MariaDB">
```bash
docker compose exec mariadb mariadb -u root -p"MYSQL_ROOT_PASSWORD" -e "SHOW DATABASES;"
```
  </Tab>
</Tabs>
</Alert>

ุงฺฏุฑ ููฺฏุงู ุงุฌุฑุง ุฏุณุชูุฑ ูุงุฑุฏ ฺฉุฑุฏู ุฏุชุงุจุณ ุจุง ุฎุทุง ููุงุฌู ุดุฏุฏุ ุนู ูุดฺฉู ูพุด ุงููุฏู. ุงุทูุงุนุงุช ุฏุชุงุจุณ ุฎูุฏุชูู ุฑู ุจุฑุฑุณ ฺฉุฑุฏู ู ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ.

#### ุญุฐู ุฏุชุงุจุณ Marzban

ุงุฒ ุงููุฌุง ฺฉู ุฏฺฏู ุจู ุฏุชุงุจุณ Marzban ูุงุฒ ูุฏุงุฑูุ ูโุชููู ุญุฐูุด ฺฉูู.
ุจุฑุง ุญุฐู ุฏุชุงุจุณ Marzbanุ ุฏุณุชูุฑ ุฒุฑ ุฑู ุงุฌุฑุง ฺฉูุฏ ู ุฏูุจุงุฑู ูพุณูุฑุฏ ุฑู ูุงุฑุฏ ฺฉูุฏ (ููุฏุงุฑ `MYSQL_ROOT_PASSWORD` ุฏุฑ `.env`):

<Alert type="error">
โ๏ธ **ูุดุฏุงุฑ**:
ุฏุณุชูุฑุงุช ุฒุฑ ุฏุชุงุจุณ Marzban ุฑู ุญุฐู ูโฺฉูู.  
ุญุชูุงู ู ุจฺฉุงูพ ฺฉุงูู ุงุฒ ุฏุชุงุชูู ุฏุงุดุชู ุจุงุดุฏ ู ุขูุงุฏู ุจุงุดุฏ ุงฺฏู ูุดฺฉู ูพุด ุงููุฏุ ุจุชููุฏ ุฏุชุง ุฑู ุจุฑฺฏุฑุฏููุฏ.
</Alert>

<Tabs items={['MySQL', 'MariaDB']}>
  <Tab value="MySQL">
```bash
rm /opt/pasarguard/marzban.sql
docker compose exec mysql mysql -u root -p -e "DROP DATABASE marzban;"
```
  </Tab>

  <Tab value="MariaDB">
```bash
rm /opt/pasarguard/marzban.sql
docker compose exec mariadb mariadb -u root -p -e "DROP DATABASE marzban;"
```
  </Tab>
</Tabs>

### 8. ุงุณฺฉุฑูพุช ูุฏุฑุช ูพุงุณุงุฑฺฏุงุฑุฏ ุฑู ูุตุจ ฺฉูุฏ

ุงุณฺฉุฑูพุช ูุฏุฑุช ูพุงุณุงุฑฺฏุงุฑุฏ ุฑู ุจุฑุง ูุฏุฑุช ุฑุงุญุชโุชุฑ ูุตุจ ฺฉูุฏ:

#### ุฏุณุชูุฑ ูุตุจ ุงุณฺฉุฑูพุช

```bash
sudo bash -c "$(curl -sL https://github.com/PasarGuard/scripts/raw/main/pasarguard.sh)" @ install-script
```

ุงู ุงุณฺฉุฑูพุช ุฏุณุชูุฑุงุช ฺฉุงุฑุจุฑุฏ ุจุฑุง ูุฏุฑุช ูุตุจ ูพุงุณุงุฑฺฏุงุฑุฏ ุจูุชูู ูุฏู.

### 9. ูพุงุณุงุฑฺฏุงุฑุฏ ุฑู ุฑุงูโุงูุฏุงุฒ ฺฉูุฏ

ุญุงูุง ูพุงุณุงุฑฺฏุงุฑุฏ ุฑู ุจุง ุชูุธูุงุช ุฌุฏุฏ ุฑุงูโุงูุฏุงุฒ ฺฉูุฏ:

#### ุฏุณุชูุฑ ุฑุงูโุงูุฏุงุฒ

```bash
pasarguard restart
```

### 10. ููุงุฌุฑุช ุฑู ุจุฑุฑุณ ฺฉูุฏ

ฺฺฉ ฺฉูุฏ ฺฉู ููู ุณุฑูุณโูุง ุฏุฑุณุช ฺฉุงุฑ ูโฺฉูู:

#### ุฏุณุชูุฑุงุช ุจุฑุฑุณ

```bash
pasarguard status
```

ุขุฏุฑุณ ูพููุชูู ุฑู ุจุงุฒ ฺฉูุฏ ุชุง ูุทูุฆู ุดุฏ ููู ฺ ุงูฺฉู.

## ูุฑุงุญู ููุงุฌุฑุช: ูุตุจ ุฌุฏุฏ

<Callout type="info"> 
๐ฌ **ุชูุฌู**:

ุฏุฑ ุงู ุฑูุด ููุงุฌุฑุชุ ุชูุธูุงุช ูุจู ุดูุง ุฏุฑ ูุงู `.env` ุจู ูพุงุณุงุฑฺฏุงุฑุฏ ููุชูู ููโุดู ู ุจุงุฏ ุฎูุฏุชูู ุงูููุง ุฑู ุจู ุตูุฑุช ุฏุณุช ูพฺฉุฑุจูุฏ ฺฉูุฏ.

ูโุชููุฏ ุชูุงู ูุชุบุฑูุง ูุงุจู ุชูุธู ุฏุงุฎู ูุงู `.env` ุฑู ุจุฑุฑุณ ฺฉูุฏุ ุง ุจุฑุง ุฌุฒุฆุงุช ุจุดุชุฑ ุจู [ูุณุชูุฏุงุช ูพฺฉุฑุจูุฏ ูพูู](/fa/panel/configuration/) ูุฑุงุฌุนู ฺฉูุฏ.

ุจุฑุฎ ุงุฒ ุชูุธูุงุช ูุซู ุฑุจุงุช ุชูฺฏุฑุงูุ ูพุดููุฏ URL ููฺฉ ุงุดุชุฑุงฺฉ ู ุจูู ููุงุฑุฏุ ุญุงูุง ูุณุชููุงู ุงุฒ ุชูุธูุงุช ุฏุงุดุจูุฑุฏ ูุงุจู ูุฏุฑุช ูุณุชูุฏ.
</Callout>

### 1. ูุตุจ ูพุงุณุงุฑฺฏุงุฑุฏ

ุงุจุชุฏุง ูพุงุณุงุฑฺฏุงุฑุฏ ุฑู ุฑู ุณุฑูุฑ ุฌุฏุฏุชูู ุจุง ุชูุฌู ุจู ุฏุชุงุจุณ ูุนูโุชูู ูุตุจ ฺฉูุฏุ ููููโุทูุฑ ฺฉู ุฏุฑ [ูุณุชูุฏุงุช ูุตุจ ูพูู](/fa/panel/installation/) ุชูุถุญ ุฏุงุฏู ุดุฏู.  
ุญุชูุงู ุฏุณุชูุฑุงูุนููโูุง ู ุชูุถุญุงุช ุฑู ุจุง ุฏูุช ูุฑูุฑ ฺฉูุฏ.

### 2. ฺฏูุงู SSL

ุจุฑุง ุฏุณุชุฑุณ ุงูู ุจู ุฏุงุดุจูุฑุฏุ ุจุงุฏ SSL ุฑู ุฑู ูพุงุณุงุฑฺฏุงุฑุฏ ูุนุงู ฺฉูุฏ.  
ูุงูโูุง ฺฏูุงู SSL ุชูู ุฑู ุฑู ุณุฑูุฑ ุขูพููุฏ ฺฉูุฏ ู ุฏุฑ ูุณุฑ `/var/lib/pasarguard/certs/` ูุฑุงุฑ ุจุฏุฏ.  
ุงฺฏู ูููุฒ ฺฏูุงู SSL ูุฏุงุฑูุ ูโุชููุฏ ฺฉ ุฏุฑุงูุช ฺฉูุฏ. [ูุณุชูุฏุงุช ูุนุงูโุณุงุฒ SSL](/fa/learn/ssl-activation-cli/) ุฑู ุจุฑุฑุณ ฺฉูุฏ. 

ููุช ฺฏูุงู SSL ุขูุงุฏู ุดุฏุ ุงูู ุฑู ุฏุฑ ูุงู `.env` ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุบุฑูุง `UVICORN_SSL` ูุนุงู ฺฉูุฏ.

```bash
pasarguard edit-env
```

### 3. ุขูพููุฏ ุฏุชุงุจุณ

ุญุงูุง ุดูุง ุจุงุฏ ุฏุชุงุจุณ ุฑู ุฑู ุณุฑูุฑ ุฎูุฏุชูู ุขูพููุฏ ฺฉูุฏ. ุฑูุด ฺฉุงุฑ ุจุณุชฺฏ ุฏุงุฑู ุจู ุงูฺฉู ุงุฒ ฺฉุฏูู ุฏุชุงุจุณ ุงุณุชูุงุฏู ูโฺฉูุฏ.

#### ูุงุฑุฏ ฺฉุฑุฏู ุฏุชุงุจุณ SQLite

- ฺฉุงูู ูุงู `db.sqlite3` ูุฑุจูุท ุจู Marzban ุฑู ุฏุงุฎู ูุณุฑ `/var/lib/pasarguard/` ูุฑุงุฑ ุจุฏุฏ. ุชูุงู.

#### ูุงุฑุฏ ฺฉุฑุฏู ุฏุชุงุจุณ MySQL ุง MariaDB

ุงฺฏู ุงุฒ ุฏุชุงุจุณ MySQL ุง MariaDB ุงุณุชูุงุฏู ูโฺฉูุฏุ ุจุงุฏ ุฏุชุงุจุณ ุฑู ุจุง ุงุณุชูุงุฏู ุงุฒ ุจุฑูุงูู **phpMyAdmin** ูุงุฑุฏ ฺฉูุฏ. ุงู ูุฑุงุญู ุฑู ุจุง ุฏูุช ุฏูุจุงู ฺฉูุฏ:

- ูุฑุงุด ูุงู ุฏุชุงุจุณ:

ุจุงุฏ ูุงู ุฏุชุงุจุณ MySQL ุง MariaDB ุฎูุฏุชูู ุฑู ูุฑุงุด ฺฉูุฏ.  
ูุงู `marzban.sql` ูุฑุจูุท ุจู ุจฺฉุงูพ ูุฑุฒุจุงู ุฑู ุจุง ฺฉ ูุฑุงุดฺฏุฑ ูุชู ุจุงุฒ ฺฉูุฏ.  
ุฏุฑ ุงู ุฏู ุฎุท ูุดุฎุต ุดุฏูุ `marzban` ุฑู ุจุง `pasarguard`  ูุซู ุชุตูุฑ ุฌุงฺฏุฒู ฺฉูุฏุ ู ูุงู ุฑู ุฐุฎุฑู ฺฉูุฏ.

<Callout type="tip">
ุงฺฏุฑ ุงู ุฏู ุฎุท ุฏุฑ ูุงูโุชูู ูุฌูุฏ ูุฏุงุฑูุฏุ ุจู ูุฑุญูู ุจุนุฏ ุจุฑุฏ.
</Callout>

<div className="grid md:grid-cols-2 gap-4">

<div className="space-y-2">
**โ ูุจู**
<img 
  src="/images/migration/edit-mysql-database-1.png" 
  alt="Edit MySQL Database 1" 
  width="900"
/>
</div>

<div className="space-y-2">
**โ ุจุนุฏ**
<img 
  src="/images/migration/edit-mysql-database-2.png" 
  alt="Edit MySQL Database 2" 
  width="900"
/>
</div>

</div>

- ูุฑูุฏ ุจู **phpMyAdmin**:

ุดูุง ูโุชููุฏ ุจู **phpMyAdmin** ุงุฒ ุทุฑู ูุฑูุฑฺฏุฑ ุฑู ุขุฏุฑุณ `http://YOUR_SERVER_IP:8010` ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ. 
ุจุง ฺฉุงุฑุจุฑ `root` ู ููุฏุงุฑ `MYSQL_ROOT_PASSWORD` ฺฉู ุฏุฑ ูุงู `.env` ูุณุช ูุงุฑุฏ ุจุดุฏ.

- ุญุฐู ุฌุฏููโูุง:

ุฌุฏููโูุง ููุฌูุฏ ุฑู ุทุจู ุชุตูุฑ ฺฉู ูุดูู ุฏุงุฏู ุดุฏู ุญุฐู ฺฉูุฏ:

<img 
  src="/images/migration/drop-mysql-tables.png" 
  alt="Drop MySQL Tables" 
  width="500" 
  height="300"
/>

- ูุงุฑุฏ ฺฉุฑุฏู ุฏุชุงุจุณ:

ุญุงูุง ุจู ุชุจ "Import" ุฏุฑ **phpMyAdmin** ุจุฑุฏ. ูุงู `marzban.sql` ุฎูุฏุชูู ุฑู ุฏุฑ ุจุฎุด "Choose File" ุงูุชุฎุงุจ ฺฉูุฏ ู ุจุนุฏ ุฑู ุฏฺฉูู Import ฺฉูฺฉ ฺฉูุฏ.

### 4. ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ PasarGuard

ุฏุฑ ููุงุชุ PasarGuard ุฑู ุฑโุงุณุชุงุฑุช ฺฉูุฏ:

```bash
pasarguard restart
```

## ุนุจโุงุจ

### ูุดฺฉูุงุช ุฑุงุฌ

> ๐ก **ูฺฉุชู**: ุจุดุชุฑ ูุดฺฉูุงุช ุจุง ุจุฑุฑุณ ุฏุณุชุฑุณโูุง ูุงู ู ุชูุธูุงุช ูุณุฑูุง ุญู ูุดู.

**1. ุงุฌุงุฒู ุฏุณุชุฑุณ ูุฏุงุฑุฏ (Permission Denied)**:
ูุทูุฆู ุดุฏ ฺฉู ุฏุณุชูุฑุงุช ุฑู ุจุง ุฏุณุชุฑุณโูุง ููุงุณุจ (sudo ุฏุฑ ุตูุฑุช ูุงุฒ) ุงุฌุฑุง ูโฺฉูุฏ.

**2. ูุดฺฉูุงุช ุงุชุตุงู ุจู ุฏุชุงุจุณ**:
ุงฺฏู ุงุฒ MySQL ุงุณุชูุงุฏู ูโฺฉูุฏุ ฺฺฉ ฺฉูุฏ ฺฉู ูุณุฑูุง ุฏุชุงุจุณ ู ุงุทูุงุนุงุช ูุฑูุฏ ุฏุฑุณุช ุจูโุฑูุฒ ุดุฏู ุจุงุดู.

**3. ุชุฏุงุฎู ูพูุฑุชโูุง**:
ูุทูุฆู ุดุฏ ฺฉู ูฺ ุณุฑูุณ ุฏฺฏูโุง ุงุฒ ูููู ูพูุฑุชโูุง ุงุณุชูุงุฏู ููโฺฉูู.

**4. ูุชุบุฑูุง ูุญุท ฺฏู ุดุฏู**:
ุฏูุจุงุฑู ฺฺฉ ฺฉูุฏ ฺฉู ููู ูุชุบุฑูุง ูุญุท ุชู ูุงู `.env` ุฏุฑุณุช ุจูโุฑูุฒ ุดุฏู ุจุงุดู.

### ุจุฑฺฏุดุช ุจู ูุณุฎู ูุจู

> โ๏ธ **ุจุงุฒฺฏุดุช ุงุถุทุฑุงุฑ**: ุงฺฏู ุจุง ูุดฺฉูุงุช ุฌุฏ ููุงุฌู ุดุฏุฏ ู ูุงุฒ ุจู ุจุงุฒฺฏุดุช ุจู ูุณุฎู ูุจู ุฏุงุฑุฏ

```bash
# ูพุงุณุงุฑฺฏุงุฑุฏ ุฑู ูุชููู ฺฉูุฏ
cd /opt/pasarguard
docker compose down

# ูพูุดูโูุง ุงุตู ุฑู ุจุฑฺฏุฑุฏููุฏ
sudo mv /opt/pasarguard /opt/marzban
sudo mv /var/lib/pasarguard /var/lib/marzban
sudo mv /var/lib/mysql/pasarguard /var/lib/mysql/marzban  # ุงฺฏู ุงุณุชูุงุฏู ูโฺฉูุฏ

# ูุงูโูุง docker-compose.yml ู .env ุงุตู ุฑู ุงุฒ ุจฺฉโุขูพ ุจุฑฺฏุฑุฏููุฏ
# ุจุนุฏ Marzban ุฑู ุฑุงูโุงูุฏุงุฒ ฺฉูุฏ
marzban up
```

## ุจุนุฏ ุงุฒ ููุงุฌุฑุช

ุจุนุฏ ุงุฒ ููุงุฌุฑุช ูููู:

- **๐ก ููุฏูุง ูพุงุณุงุฑฺฏุงุฑุฏ**: ููุฏูุง ูพุงุณุงุฑฺฏุงุฑุฏ ุฑู ูุตุจ ู ูุชุตู ฺฉูุฏ. ุฎูุฏ ูพุงุณุงุฑฺฏุงุฑุฏ ุจูโุชููุง Xray-Core ุฑู ุงุฌุฑุง ููโฺฉูู.
- **๐ ูุงูุชูุฑูฺฏ ุฑู ุจูโุฑูุฒ ฺฉูุฏ**: ุงฺฏู ุงุจุฒุงุฑูุง ูุงูุชูุฑูฺฏ ุฏุงุฑุฏุ ุงููโูุง ุฑู ุจู ูุณุฑูุง ุฌุฏุฏ ูุชุตู ฺฉูุฏ.
- **๐พ ุจฺฉโุขูพโูุง ุฑู ุจูโุฑูุฒ ฺฉูุฏ**: ูุทูุฆู ุดุฏ ฺฉู ุงุณฺฉุฑูพุชโูุง ุจฺฉโุขูพุชูู ุจุฑุง ุจฺฉโุขูพ ฺฏุฑูุชู ุงุฒ ูพูุดูโูุง ุฌุฏุฏ ุจูโุฑูุฒ ุดุฏู.
- **๐งช ููู ูุงุจูุชโูุง ุฑู ุชุณุช ฺฉูุฏ**: ููู ูุงุจูุชโูุง ูพูู ุฑู ฺฉุงูู ุชุณุช ฺฉูุฏ ุชุง ูุทูุฆู ุดุฏ ููู ฺ ุฏุฑุณุช ฺฉุงุฑ ูโฺฉูู.

## ูพุดุชุจุงู

๐ **ููฺฉโูุง**

- **ฺฏุฑูู ุจุญุซ ู ฺฏูุชฺฏู**: [Telegram](https://t.me/PasarGuardGP)
- **ูุดฺฉูุงุช**: ุงฺฏู ุชู ุทูู ููุงุฌุฑุช ุจู ูุดฺฉู ุจุฑุฎูุฑุฏุฏุ ู issue ุจุณุงุฒุฏ.

---

> **๐ ูฺฉุชู**: ุงู ุฑุงูููุง ูุฑุถ ุฑู ุจุฑ ุงู ูุฐุงุฑู ฺฉู ูุตุจ Marzban ุงุณุชุงูุฏุงุฑุฏ ุจูุฏู. ุชูุธูุงุช ุดุฎุต ููฺฉูู ูุงุฒ ุจู ูุฑุงุญู ุงุถุงู ุฏุงุดุชู ุจุงุดู.
