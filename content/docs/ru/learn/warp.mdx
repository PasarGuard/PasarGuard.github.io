---
title: Активация CloudFlare Warp
navigation: CloudFlare Warp
icon: Cloud
---

С помощью этого руководства вы можете обойти определенные ограничения, наложенные крупными компаниями, такими как Google и Spotify, на ваш IP и использовать их сервисы без проблем.

<Callout type="warn">
Обратите внимание, что конфигурации Warp имеют максимальное ограничение подключения 5 одновременных устройств. Чтобы решить эту проблему, вы можете использовать несколько конфигураций.
</Callout>

## Шаг 1: Создание конфигурации Wireguard

### Метод 1: Использование Windows

1. Сначала загрузите необходимый `Asset` из раздела [releases](https://github.com/ViRb3/wgcf/releases). Этот файл зависит от вашего процессора.
2. Переименуйте файл `Asset` в `wgcf`.
3. Теперь введите `cmd.exe` в адресной строке проводника.

<ImageZoom
  src="/images/learn/warp-cmd-terminal.png"
  alt="Открытие командного терминала в проводнике"
  width={800}
  height={400}
/>

4. В открывшемся терминале введите `wgcf.exe`.
5. Выполните `wgcf.exe register` один раз, затем `wgcf.exe generate`.
6. Будет создан новый файл с именем `wgcf-profile.conf` - это конфигурация `Wireguard`, которая нам нужна.
7. Ваша конфигурация готова, и вы можете её использовать.

### Метод 2: Использование Linux

Сначала загрузите необходимый `Asset` из раздела [releases](https://github.com/ViRb3/wgcf/releases). Этот файл зависит от вашего процессора.

Вы можете сделать это с помощью команды `wget`.

#### Для процессоров архитектуры AMD64:

```bash
wget https://github.com/ViRb3/wgcf/releases/download/v2.2.22/wgcf_2.2.22_linux_amd64
```

#### Для процессоров архитектуры ARM64:

```bash
wget https://github.com/ViRb3/wgcf/releases/download/v2.2.22/wgcf_2.2.22_linux_arm64
```

Переместите файл в `/usr/bin/` и переименуйте его в `wgcf`.

#### Для процессоров архитектуры AMD64:

```bash
mv wgcf_2.2.22_linux_amd64 /usr/bin/wgcf
chmod +x /usr/bin/wgcf
```

#### Для процессоров архитектуры ARM64:

```bash
mv wgcf_2.2.22_linux_arm64 /usr/bin/wgcf
chmod +x /usr/bin/wgcf
```

Затем создайте конфигурацию с помощью этих 2 команд:

```bash
wgcf register
wgcf generate
```

Будет создан файл с именем `wgcf-profile.conf` - это конфигурация, которая нам нужна.

## Шаг 2: Использование Warp+ (Необязательно)

Чтобы получить лицензию и использовать Warp+, вы можете получить `license_key` через [этого](https://t.me/generatewarpplusbot) Telegram-бота.

После получения `license_key` вам нужно заменить его в файле `wgcf-account.toml`.

<Callout type="info">
Вы можете внести это изменение в Linux с помощью `nano`, а в Windows с помощью `Notepad` или любого другого программного обеспечения.
</Callout>

<Callout type="info" title="Windows">
Чтобы использовать команды в Windows, вам нужно использовать `wgcf.exe` вместо `wgcf`.
</Callout>

Затем обновите информацию о конфигурации:

```bash
wgcf update
```

Затем создайте новый файл конфигурации:

```bash
wgcf generate
```

## Шаг 3: Активация Warp в PasarGuard

### Метод 1: Использование Xray Core

<Callout type="warn">
- Этот метод рекомендуется только для Xray версии 1.8.3 или выше. В более старых версиях у вас могут возникнуть проблемы с утечкой памяти.
- Если ваша версия `Xray` ниже этой, вы можете обновить версию `Xray` с помощью руководства по изменению версии Xray-core.
</Callout>

Перейдите в Core Setting в панели PasarGuard.

Сначала добавьте outbound, как в примере, и поместите в него информацию из файла `wgcf-profile.conf`.

```json
{
  "tag": "warp",
  "protocol": "wireguard",
  "settings": {
    "secretKey": "Your_Secret_Key",
    "DNS": "1.1.1.1",
    "address": ["172.16.0.2/32", "2606:4700:110:8756:9135:af04:3778:40d9/128"],
    "peers": [
      {
        "publicKey": "bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=",
        "endpoint": "engage.cloudflareclient.com:2408"
      }
    ],
    "kernelMode": false
  }
}
```

<Callout type="info">
Если вы хотите, чтобы весь трафик по умолчанию проходил через Warp, поместите этот Outbound первым, и вам не нужно будет выполнять следующий шаг.
</Callout>

### Метод 2: Использование Wireguard Core

Сначала установите предварительные требования Wireguard на сервере:

```bash
sudo apt install wireguard-dkms wireguard-tools resolvconf
```

Если вы используете Ubuntu 24, используйте следующую команду для установки Wireguard:

```bash
sudo apt install wireguard
```

Затем добавьте `Table = off` в файл Wireguard, как показано в примере:

```ini
[Interface]
PrivateKey = Your_Private_Key
Address = 172.16.0.2/32
Address = 2606:4700:110:8a1a:85ef:da37:b891:8d01/128
DNS = 1.1.1.1
MTU = 1280
Table = off
[Peer]
PublicKey = bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=
AllowedIPs = 0.0.0.0/0
AllowedIPs = ::/0
Endpoint = engage.cloudflareclient.com:2408
```

<Callout type="warn">
Если вы не добавите `Table = off`, доступ к вашему серверу будет отключен, и вы не сможете подключиться к серверу. Вам нужно будет получить доступ к серверу через веб-сайт вашего дата-центра и отключиться от `Warp`, чтобы снова установить нормальное соединение.
</Callout>

Затем переименуйте файл с `wgcf-profile.conf` на `warp.conf`.

Поместите файл в папку `/etc/wireguard` на сервере:

```bash
sudo mv wgcf-profile.conf /etc/wireguard/warp.conf
```

Включите Wireguard с помощью следующей команды:

```bash
sudo systemctl enable --now wg-quick@warp
```

Вы также можете отключить `Warp` с помощью этой команды:

```bash
sudo systemctl disable --now wg-quick@warp
```

Перейдите в Core Setting в панели PasarGuard.

Сначала добавьте outbound, как в примере:

```json
{
  "tag": "warp",
  "protocol": "freedom",
  "streamSettings": {
    "sockopt": {
      "tcpFastOpen": true,
      "interface": "warp"
    }
  }
}
```

<Callout type="info">
Если вы хотите, чтобы весь трафик по умолчанию проходил через Warp, поместите этот Outbound первым, и вам не нужно будет выполнять следующий шаг.
</Callout>

## Шаг 4: Конфигурация маршрутизации

Сначала добавьте `rule` в разделе `routing`, как в примере:

```json
{
  "outboundTag": "warp",
  "domain": [],
  "type": "field"
}
```

Теперь добавьте нужные вам веб-сайты, как в примере:

```json
{
    "outboundTag": "warp",
    "domain": [
        "geosite:google",
        "openai.com",
        "ai.com",
        "ipinfo.io",
        "iplocation.net",
        "spotify.com"
    ],
    "type": "field"
}
```

Сохраните изменения - теперь вы можете использовать `Warp`.

### PasarGuard Node

- Если вы используете `Warp` с ядром xray, вам не нужно вносить изменения в узел - это будет применено автоматически.
- Если вы используете ядро `Wireguard`, вам нужно выполнить шаг три, метод два на узле также.
